{% extends "base.html"%}

{% block title %}Search{% endblock %}

{% block content %}
<div class="info-page-container">
    <div class="home-section" id="home-search">
        <div class="input-container">
            <h3>Sök igenom vår databas genom att söka på en frukt eller grönsak!</h3>
            <form action="/search" method="GET">
                <input type="search" placeholder="Sök på t.ex tomat, gurka..." name="search">
                <button><i class="fa-solid fa-magnifying-glass"></i></button>
            </form>
        </div>

            
        
        <section class="search-section">          
            <article class="info-article">

            {% if searched_page %}
                <h1> {{searched_page['name']}} </h1>

                <img src="{{ searched_page['img'] }}">
                {% if api_image %}
                <img src="{{ api_image }}">
                {% endif %}

                <div class="api-info">
                <p><strong> Fakta: </strong> {{ searched_page['fact'] }}</p>
            </div>                
            {% endif %}

                </article>
                <article class="table-article">
                    <div class="table-container">
                        <!-- <div class="container-search"> -->
                            <div class="nutrition-info">
                                {% if results %}
                                <table class="container-search center-table">
                                    <thead>
                                        <th>Sökträffar</th>
                                    </thead>
                                    <tbody>
                                        {% for item in results %}
                                        <tr>
                                            <td>
                                                <a href="/{{item.Namn}} ">{{item.Namn}} </a>
                                            </td>
                                        </tr>
                                        {% endfor %} 
                                    </tbody>
                                </table>
                                {% endif %}

        {% if searched_page %}
            {# <h2> {{ searched_page['name'] }} </h2> #}
            <table class="container-search">
                <thead>
                        <th>Vitaminer</th>
                        <th>Per 100g</th>
                </thead>
                <tbody>
                    {% for key in searched_page['object'] %}
                        
                    {% if searched_page['object'][key] > 0 and key in (searched_page['vitamins'].keys()|list)   %}
                    {% set unit = key.split("_")[-1] %}
                    <tr>
                        <td> {{ searched_page['vitamins'][key] }} </td>
                        <td> {{ searched_page['object'][key] }} {{unit}} </td>
                    </tr>
                    {% endif %}
                    {% endfor %}  
                </tbody>
            </table>

            <table class="container-search">
                <thead>
                        <th>Mineraler</th>
                        <th>Per 100g</th>
                </thead>
                <tbody>
                    {% for key in searched_page['object'] %}
                        
                    {% if searched_page['object'][key] > 0 and key in (searched_page['minerals'].keys()|list)  %}
                    {% set unit = key.split("_")[-1] %}
                    <tr>
                        <td> {{ searched_page['minerals'][key] }}  </td>
                        <td> {{ searched_page['object'][key] }} {{ unit }} </td>
                    </tr>
                    {% endif %}
                    {% endfor %}  
                </tbody>
            </table>
        {% endif %}

                            </div>
                        <!-- </div> -->
                    </div>
                </article>
            </section>

            {% if condition %}
            <div id="default-section">       
                <h2>Message</h2>            
            </div>
            {% endif %}


           

                 
        {% if not searched_page and results==False %}
        <div id="default-section">
            <h2>Sökfunktionen</h2>
            <p>Genom att använda sökrutan kan du snabbt och enkelt få mer detaljerad 
                information om frukt och grönt från vår databas. 
                Skriv in namnet på den frukt eller grönsak du är intresserad av, 
                och du kommer att få tillgång till detaljerade fakta, näringsvärden.</p>
        </div> 
        {% endif %}

        {% if results is iterable and results|length==0 and not searched_page %}
        <h2>Ingen sökträff hittades</h2>   
        {% endif %}
    </div>
</div>
{% endblock %}